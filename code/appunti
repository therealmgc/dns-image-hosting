REFS:
   https://asherfalcon.com/blog/posts/2
   https://hub.docker.com/r/technitium/dns-server
   https://github.com/TechnitiumSoftware/DnsServer/blob/master/APIDOCS.md
   https://stackoverflow.com/questions/296536/how-to-urlencode-data-for-curl-command

SETUP:
   docker compose up -d
   
DNS UI:   
   http://192.168.56.101:5380/   # admin/password -> mandatorio primo setup
   
   Zones -> Add Zone: labyrinth.lab
      Poi click su labyrinth.lab
         Add record
            Type: TXT
            Text Data: aW50byB0aGUgbGFieXJpbnRoCg==
            Comment: echo "into the labyrinth"| base64
         Add record
            Type: TXT
            Text Data: YW5kIG1vcmUK
            Comment: echo "and more" |  base64
   
   caricamento con API: https://github.com/TechnitiumSoftware/DnsServer/blob/master/APIDOCS.md
      TOKEN=$(curl -s "http://localhost:5380/api/user/login?user=admin&pass=password" | jq -r .token)     
      echo "TOKEN=$TOKEN"    #e1b4b90a7d20ad2024e1fb7cc55a6edda89267a322700e610f2fd94d5d27a9dc
      DOMAIN="labyrinth.lab"            

      # solo il primo ha overwrite
      curl -s --data-urlencode "comments=echo 'into the labyrinth'| base64"   "http://localhost:5380/api/zones/records/add?token=$TOKEN&domain=$DOMAIN&type=TXT&text=aW50byB0aGUgbGFieXJpbnRoCg==&overwrite=true"     
      # le altre chiamate successive in aggiunta       
      curl -s --data-urlencode "comments=and more" "http://localhost:5380/api/zones/records/add?token=$TOKEN&domain=$DOMAIN&type=TXT&text=YW5kIG1vcmUK"

      dig @localhost txt labyrinth.lab
         ; <<>> DiG 9.16.23-RH <<>> @localhost txt labyrinth.lab
         ; (2 servers found)
         ;; global options: +cmd
         ;; Got answer:
         ;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 52130
         ;; flags: qr aa rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1

         ;; OPT PSEUDOSECTION:
         ; EDNS: version: 0, flags:; udp: 1232
         ;; QUESTION SECTION:
         ;labyrinth.lab.                 IN      TXT

         ;; ANSWER SECTION:
         labyrinth.lab.          3600    IN      TXT     "aW50byB0aGUgbGFieXJpbnRoCg=="
         labyrinth.lab.          3600    IN      TXT     "YW5kIG1vcmUK"

         ;; Query time: 4 msec
         ;; SERVER: ::1#53(::1)
         ;; WHEN: Thu Sep 04 13:47:22 CEST 2025
         ;; MSG SIZE  rcvd: 108

      dig @localhost txt labyrinth.lab | grep TXT | awk '{print $5}' | tr -d \" |  base64 -d | tr '\n' ' ' && echo 
         # into the labyrinth and more 
      
      
      #esiste token che non scade? si, ma on sembra funzionare
       curl -s http://localhost:5380/api/user/createToken?user=admin&pass=password&tokenName=MyToken1
       
      #esempio:
         [devops@xpl-template code]$ pwd
            /home/devops/dns-txt-records/code
         [devops@xpl-template code]$ cat history
             file RCSlogo.png
             cat RCSlogo.png |base64 > RCSlogo.b64
             man xxd
             cat RCSlogo.png | xxd -p > RCSlogo.hex
             ll   # base64 is more efficient
             cat RCSlogo.b64 | split -b 2048 RCSlogo.b64 b64_
             ll
             cat b64_aa
             cat b64_ab
             cat b64* > RCSlogo.b64.rec

# CREDITS
Image by azzy_roth from Pixabay
https://pixabay.com/users/azzy_roth-143196/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=276452

# TODO
- differenziare procedura, una per caricare e l'altra per scaricare.
  Uso server kalilinux come dns server e questa macchina come host 

  es:
    [devops@xpl-template code]$ dig @192.168.56.101 +short TXT  b64-000.labyrinth.lab
    "iVBORw0KGgoAAAANSUhEUgAAAoAAAAHfCAMAAAD3I5muAAADAFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"

- fare esempio con immagine e con binario malevolo 

